startdate <- as.Date('1996')
startdate <- as.Date('1996-01-01')
enddate <- as.Date('2009-01-01')
num <- c(132616, 132410, 124250, 109126, 106988, 120900, 138369, 160300, 187341, 206068, 221056, 235445, 260552, 274618)
tsales<-ts(sales,start=c(1996),end=c(2009))
tsales<-ts(num,start=c(1996),end=c(2009))
data<-ts(num,start=c(1996),end=c(2009))
data
plot(data)
Energy <- ts(num,start=c(1996),end=c(2009))
Energy
plot(Energy)
plot(Energy,type='b',
col='red',lty=2,pch=2,lwd=2,
main='Clinical Trials for Drug A',
sub='This is hypothetical data',
xlab='Dosage',ylab='Drug Response')
plot(Energy,type='b',
lty=2,pch=2,lwd=2,
main='我国1996-2009年能源生产总量趋势图',
xlab='年份',ylab='生产量')
quartzFonts('simHei')
quartz(family=’STKaiti’)
quartz(family=’STKaiti’)
plot(Energy,type='b',
lty=2,pch=2,lwd=2,
main='我国1996-2009年能源生产总量趋势图',
xlab='年份',ylab='生产量',family='STKaiti)
;
.
;
q
;
)
plot(Energy,type='b',
lty=2,pch=2,lwd=2,
main='我国1996-2009年能源生产总量趋势图',
xlab='年份',ylab='生产量',family='STKaiti')
SMA(Energy, n=5);
library(TTR)
install.packages('TTR')
library(TTR)
SMA(Energy, n=5);
SMA(Energy, n=3);
Energy
SMA(Energy, n=3);
plot(SMA(Energy, n=3))
plot(SMA(SMA(Energy, n=3),n=3))
summary(SMA(Energy,n=3))
plot(EMA(Energy, n=3, ratio=0.6))
plot(EMA(EMA(Energy, n=3, ratio=0.6), n=3, ratio=0.6))
plot(EMA(Energy,ratio=0.6))
plot(EMA(EMA(Energy,ratio=0.6),ratio=0.6))
Energy
EMA(Energy,ratio=0.6)
EMA(EMA(Energy,ratio=0.6),ratio=0.6)
Energy
SMA(Energy, n=3)
SMA(SMA(Energy, n=3),n=3)
SMA(Energy, n=5)
SMA(Energy, n=3)
plot(SMA(Energy, n=3),family='STKaiti')
plot(SMA(SMA(Energy, n=3),n=3),family='STKaiti')
dose <- c(20,30,40,45,60)
drugA <- c(16,20,27,40,60)
drugB <- c(15,18,25,31,40)
plot(dose,drugA,type='b')
pie(rep(1,n),rainbow(10))
par(mfrow=c(m,n))
par(mfrow=c(2,2))
plot(SMA(Energy, n=3),family='STKaiti')
plot(SMA(SMA(Energy, n=3),n=3),family='STKaiti')
plot(EMA(Energy,ratio=0.6),family='STKaiti')
plot(EMA(EMA(Energy,ratio=0.6),ratio=0.6),family='STKaiti')
par(mfrow=c(2,2))
plot(SMA(Energy, n=3),xlab='一次移动平均法 n=3',family='STKaiti')
plot(SMA(SMA(Energy, n=3),n=3),xlab='二次移动平均法 n=3',family='STKaiti')
plot(EMA(Energy,ratio=0.6),,xlab='一次指数平滑法 a=0.6',family='STKaiti')
plot(EMA(EMA(Energy,ratio=0.6),ratio=0.6),'二次指数平滑法 a=0.6'，family='STKaiti')
par(mfrow=c(2,2))
par(mfrow=c(2,2))
plot(SMA(Energy, n=3),xlab='一次移动平均法 n=3',family='STKaiti')
plot(SMA(SMA(Energy, n=3),n=3),xlab='二次移动平均法 n=3',family='STKaiti')
plot(EMA(Energy,ratio=0.6),xlab='一次指数平滑法 a=0.6',family='STKaiti')
plot(EMA(EMA(Energy,ratio=0.6),ratio=0.6),xlab='二次指数平滑法 a=0.6',family='STKaiti')
dose <- c(20,30,40,45,60)
drugA <- c(16,20,27,40,60)
drugB <- c(15,18,25,31,40)
plot(dose,drugA,type='b')
par(mfrow=c(2,2))
plot(SMA(Energy, n=3),xlab='一次移动平均法 n=3',family='STKaiti',type='b')
plot(SMA(SMA(Energy, n=3),n=3),xlab='二次移动平均法 n=3',family='STKaiti',type='b')
plot(EMA(Energy,ratio=0.6),xlab='一次指数平滑法 a=0.6',family='STKaiti',type='b')
plot(EMA(EMA(Energy,ratio=0.6),ratio=0.6),xlab='二次指数平滑法 a=0.6',family='STKaiti',type='b')
SMA1 <- SMA(Energy, n=3)
SMA2 <- SMA(SMA(Energy, n=3),n=3)
EMA1 <- EMA(Energy,ratio=0.6)
EMA2 <- EMA(EMA(Energy,ratio=0.6),ratio=0.6)
all <- data.frame(SMA1, SMA2, EMA1, EMA2)
View(all)
all <- data.frame(Energy, SMA1, SMA2, EMA1, EMA2)
all[15,1]
all[14,2]
?sum
all[15,2] <- sum((all$SMA1-all$Energy)/all$Energy,na.rm = T)
sum((all$SMA1-all$Energy)/all$Energy,na.rm = T)
sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)
sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = F)
all[15,2] <- sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)/1-is.na(all$SMA1)
sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)/1-is.na(all$SMA1)
sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)/(1-is.na(all$SMA1))
is.na(all)
sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)/(1-sum(is.na(all$SMA1)))
sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)/(14-sum(is.na(all$SMA1)))
S1 <- sum((abs(all$SMA1-all$Energy))/all$Energy,na.rm = T)/(14-sum(is.na(all$SMA1)))
S2 <- sum((abs(all$SMA2-all$Energy))/all$Energy,na.rm = T)/(14-sum(is.na(all$SMA2)))
E1 <- sum((abs(all$EMA1-all$Energy))/all$Energy,na.rm = T)/(14-sum(is.na(all$EMA1)))
E2 <- sum((abs(all$EMA2-all$Energy))/all$Energy,na.rm = T)/(14-sum(is.na(all$EMA2)))
a <- c(Na, S1, S2, E1, E2)
a <- c(NA, S1, S2, E1, E2)
all <- rbind(all,a)
all[15] <- a
View(all)
all <- (all,a)
all <- (all,a)
all <- data.frame(all,a)
all <- data.frame(all,a)
all[15] <- a
a <- data.frame(c(NA, S1, S2, E1, E2))
all <- data.frame(all,a)
View(a)
View(a)
library(readxl)
山西汾酒数据 <- read_excel("~/Documents/经济预测与决策/山西汾酒数据.xlsx",
range = "B1:G234")
View(山西汾酒数据)
sxfj <- read_excel("~/Documents/经济预测与决策/山西汾酒数据.xlsx", range = "B1:G234")
View(山西汾酒数据)
cor(sxfj)
cor <- cor(sxfj)
View(cor)
library(car)
install.packages('car')
library(car)
install.packages('carData')
install.packages("carData")
library(car)
scatterplotMatrix(sxfj)
scatterplotMatrix(sxfj，family = 'SimSun')
scatterplotMatrix(sxfj, family = 'SimSun')
scatterplotMatrix(sxfj, family = '宋体')
fit <- lm(收盘价 ~ 开盘价 + 最高价 + 最低价 + 成交量 + 成交额, data = sxfj)
View(fit)
summary(fit)
fit1 <- summary(fit)
View(fit1)
fit[["assign"]]
install.packages("stargazer")
library(stargazer)
install.packages("stargazer")
install.packages("stargazer")
library(stargazer)
stargazer(fit)
stargazer(sxfj)
stargazer(sxfj, type = 'html')
stargazer(sxfj, type = 'html', out = '~/Desktop/1.html')
stargazer(fit, type = 'html', out = '~/Desktop/1.html')
sxfj1 <- scale(sxcj,center=T,scale=T)
sxfj1 <- scale(sxfj,center=T,scale=T)
View(sxfj1)
fit <- lm(收盘价 ~ 开盘价 + 最高价 + 最低价 + 成交量 + 成交额, data = sxfj1)
sxfj1 <- data.frame(scale(sxfj,center=T,scale=T))
fit <- lm(收盘价 ~ 开盘价 + 最高价 + 最低价 + 成交量 + 成交额, data = sxfj1)
fit1 <- summary(fit)
stargazer(fit, type = 'html', out = '~/Desktop/1.html')
stargazer(cor(sxfj1, type = 'html', out = '~/Desktop/1.html'))
stargazer(cor(sxfj1), type = 'html', out = '~/Desktop/1.html')
stargazer(fit, type = 'html', out = '~/Desktop/2.html')
plot(fit)
font.add('SimSun','SimSun.ttf')
library(showtext)
par(family='STKaiti')
plot(fit)
plot(fit)
bptest(sxfj1)
library(lmtest)
install.packages('lmtest')
bptest(sxfj1)
library(lmtest)
install.packages('zoo')
install.packages("zoo")
library(lmtest)
bptest(sxfj1)
bptest(sxfj1)
bptest(sxfj1$开盘价)
bptest(sxfj1)
bptest(fit)
stargazer(bptest(fit), type = 'html', out = '~/Documents/经济预测与决策/图片/bp.html')
bptest(fit)
bp <- bptest(fit)
View(bp)
stargazer(bp, type = 'html', out = '~/Documents/经济预测与决策/图片/bp.html')
stargazer(fit, type = 'html', out = '~/Desktop/2.html')
plot(fit)
library(car)
vif(sxfj1)
vif(fit)
vif(fit, digits=3)
plot(cor(sxfj1))
plot(sxfj1)
stargazer(vif(fit))
stargazer(vif(fit), type = 'html', out = '~/Documents/经济预测与决策/图片/vif.html')
kappa(fit)
View(bp)
v <- vif(fit)
par(mfrow=c(2,2))
plot(fit)
sqrt(vif(fit)) > 2
stargazer(vif(fit),sqrt(vif(fit)) > 2, type = 'html', out = '~/Documents/经济预测与决策/图片/vif.html')
anova(fit)
stargazer(anova(fit), type = 'html', out = '~/Documents/经济预测与决策/图片/anova.html')
stargazer(summary(sxfj1), type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
summary(sxfj1)
summary(sxfj)
stargazer(summary(sxfj1), type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(summary(sxfj), type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
View(sxfj)
stargazer(sxfj, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(sxfj, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(sxfj, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(summary(sxfj), type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
s <- summary(sxfj)
s <- data.frame(summary(sxfj))
View(s)
stargazer(s, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(s, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(sxfj, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(sxfj, header = F, type = 'html', out = '~/Documents/经济预测与决策/图片/summary.html')
stargazer(sxfj, header = F, type = 'html', out = '~/Desktop/summary.html')
stargazer(sxfj[1:4,], header = F, type = 'html', out = '~/Desktop/summary.html')
attitude
sxfj
stargazer(sxfj, summary = T, header = F, type = 'html', out = '~/Desktop/summary.html')
stargazer(sxfj1, summary = T, header = F, type = 'html', out = '~/Desktop/summary.html')
sxfj <- read_excel("~/Documents/经济预测与决策/山西汾酒数据.xlsx", range = "B1:G234")
stargazer(sxfj, type = 'html', out = '~/Desktop/s.html')
stargazer(sxfj, out = '~/Desktop/s.html')
stargazer(sxfj1, out = '~/Desktop/s.html')
stargazer(sxfj, out = '~/Desktop/s.html')
sxfj2 <- data.matrix(sxfj)
View(sxfj2)
stargazer(sxfj2, out = '~/Desktop/s.html')
stargazer(summary(sxfj2), out = '~/Desktop/s.html')
sxfj2 <- data.frame(sxfj)
stargazer(summary(sxfj2), out = '~/Desktop/s.html')
stargazer(sxfj2, out = '~/Desktop/s.html')
View(fit)
fit <- lm(收盘价 ~ 开盘价 + 最高价 + 最低价 + 成交量 + 成交额, data = sxfj1)
stargazer(fit, type = 'html', out = '~/Documents/经济预测与决策/图片/lm.html')
fit
summary(fit)
dwtest(sxfj1)
dwtest(data.matrix(sxfj1))
dwtest(sxfj)
dwtest(sxfj1)
durbinWatsonTest(sxfj1)
durbinWatsonTest(data.matrix(sxfj1))
dwtest(fit)
stargazer(dwtest(fit), out = '~/Desktop/dw.html')
install.packages('psych')
library(psych)
KMO(cor(sxfj1))
stargazer(KMO(cor(sxfj1)), out = '~/Desktop/kmo.html')
bartlett.test(cor(sxfj1))
bartlett.test(cor(sxfj1))
bartlett.test(sxfj1)
sxfj1$开盘价$cov
sxfj1$cov
cov(sxfj1)
fa.parallel(cor(sxfj1), n.obs = 233, fa='both')
par(mfrow=c(1,1))
fa.parallel(cor(sxfj1), n.obs = 233, fa='both')
fa.parallel(cor(sxfj1), n.obs = 233, fa='both', n.iter=100)
fa.parallel(cor(sxfj1), n.obs = 233, fa='both')
fa.parallel(cor(sxfj1), n.obs = 233, fa='both', n.iter=100)
fa.parallel(cor(sxfj1), n.obs = 233, fa='fa', n.iter=100)
fa <- fa(cor(sxfj1, nfactors(2), rotate='none', fm='pa'))
fa <- fa(cor(sxfj1), nfactors(2), rotate='none', fm='pa')
fa <- fa(cor(sxfj1), nfactors(2), rotate='none')
fa.parallel(cor(sxfj1), n.obs = 233, fa='pa', n.iter=100)
fa.parallel(cor(sxfj1), n.obs = 233, fa='pc', n.iter=100)
fa <- fa(sxfj1, nfactors(2), rotate='none')
fa.parallel(sxfj1, n.obs = 233, fa='pc', n.iter=100)
fa.parallel(sxfj1, n.obs = 233, fa='both', n.iter=100)
?fa.parallel
Harman74.cor
Harman74.cor$cov
thurstone()
Thurstone
cov(sxfj1)
cor(sxfj1)
cov2cor(cov(sxfj1))
fa <- fa(cov(sxfj1), nfactors(2), rotate='none')
fa <- fa(cor(sxfj1), nfactors(2), rotate='none')
sxfj1$cov
sxfj1$cor
fa <- fa(data.matrix(cor(sxfj1)), nfactors(2), rotate='none')
fa <- fa(cor(sxfj1), nfactors(2), rotate='none')
fa <- principal(cor(sxfj1), nfactors(2), rotate='none')
View(sxfj1)
sxfj_cor <- cor(sxfj1)
View(sxfj_cor)
fa.parallel(sxfj_cor, n.obs = 233, fa='both', n.iter=100)
fa <- principal(sxfj_cor), nfactors(2), rotate='none')
fa <- principal(sxfj_cor), nfactors(2), rotate='none')
fa <- principal(sxfj_cor), nfactors(2), rotate='none'))
fa <- principal((sxfj_cor), nfactors(2), rotate='none')
library(psych)
kmo
o
fa <- fa((sxfj_cor), nfactors(2), rotate='none')
kmo
fa <- fa((sxfj_cor), nfactors(2), rotate='none')
fa <- fa((sxfj_cor), nfactors(2))
fa <- fa((sxfj_cor))
View(fa)
fa
fa <- fa((sxfj_cor), nfactors(2))
fa <- fa((sxfj_cor), nfactors(1))
fa <- fa((sxfj_cor), nfactors(3))
fa <- fa((sxfj_cor), nfactors())
fa <- fa((sxfj_cor), nfactors(0))
USJudgeRatings
USJudgeRatings[,-1]
fa <- principal((sxfj_cor), nfactors(0))
fa <- principal((sxfj_cor), nfactors(2))
pc <- principal(Harman23.cor$cov, nfactors = 2)
View(pc)
pc <- principal(sxfj_cor, nfactors = 2)
fa <- fa(sxfj_cor, nfactors = 2)
fa <- fa(sxfj_cor, nfactors = 2)
install.packages('GPArotation')
fa <- fa(sxfj_cor, nfactors = 2)
library(psych)
fa <- fa(sxfj_cor, nfactors = 2)
View(fa)
fa
fa <- fa(sxfj_cor, nfactors = 2, rotate='none', fm='pa')
fa
fa <- fa(sxfj_cor, nfactors = 2, rotate='varimax', fm='pa')
fa
fa <- fa(sxfj_cor, nfactors = 2, rotate='promax', fm='pa')
fa
stargazer(fa)
factor.plot(fa.promax)
factor.plot(fa)
factor.plot(fa, lables=rownames)
factor.plot(fa, lables=rownames)
factor.plot(fa, lables=rownames(fa.promax$loadings))
fa.graph()
factor.plot(fa, lables=rownames(fa$loadings))
fa <- fa(sxfj_cor, nfactors = 2, rotate='none', fm='pa')
factor.plot(fa, lables=rownames(fa$loadings))
fa <- fa(sxfj_cor, nfactors = 2, rotate='varimax', fm='pa')
factor.plot(fa, lables=rownames(fa$loadings))
fa <- fa(sxfj_cor, nfactors = 2, rotate='promax', fm='pa')
factor.plot(fa, lables=rownames(fa$loadings))
fa.diagram(fa, simple = F)
fa <- fa(sxfj_cor, nfactors = 2, rotate='none', fm='pa')
fa.diagram(fa, simple = F)
fa <- fa(sxfj_cor, nfactors = 2, rotate='varimax', fm='pa')
fa.diagram(fa, simple = F)
factor.plot(fa, lables=rownames(fa$loadings))
fa <- fa(sxfj_cor, nfactors = 2, rotate='promax', fm='pa')
fa <- fa(sxfj_cor, nfactors = 2, rotate='promax', fm='pa')
fa
View(cor)
sxfj_cor <- cor(sxfj1[,-1])
View(sxfj_cor)
sxfj_cor <- cor(sxfj1)
sxfj_cor <- cor(sxfj1[,-6])
fa.parallel(sxfj_cor, n.obs = 233, fa='both', n.iter=100)
fa <- fa(sxfj_cor, nfactors = 2, rotate='promax', fm='pa')
fa
factor.plot(fa, lables=rownames(fa$loadings))
fa.diagram(fa, simple = F)
fa <- fa(sxfj_cor, nfactors = 2, rotate='varimax', fm='pa')
fa
factor.plot(fa, lables=rownames(fa$loadings))
fa.diagram(fa, simple = F)
fa$weights
fa
fa$weights[1]
fa$weights[2]
fa$weights[6]
f1 <- sxfj1$开盘价*fa$weights[1]+sxfj1$最高价*fa$weights[2]+sxfj1$最低价*fa$weights[3]+sxfj1$成交量*fa$weights[4]+sxfj1$成交额*fa$weights[5]
f2 <- sxfj1$开盘价*fa$weights[6]+sxfj1$最高价*fa$weights[7]+sxfj1$最低价*fa$weights[8]+sxfj1$成交量*fa$weights[9]+sxfj1$成交额*fa$weights[10]
sxfj2 <- data.frame(sxfj1,f1,f2)
View(sxfj2)
fit2 <- lm(收盘价 ~ f1 + f2, data = sxfj2)
summary(fit2)
cor(f1,f2)
vif(cor(f1,f2))
vif(fit2)
stargazer(fit2, out = '~/Desktop/fit2.html')
par(mfrow=c(2,2))
plot(fit2)
vif(fit2)
cor(f1,f2)
vif(fit2)
View(sxfj)
library(readxl)
sxfj <- read_excel("~/Documents/经济预测与决策/山西汾酒数据.xlsx", range = "B1:G234")
sxfj1 <- data.frame(scale(sxfj,center=T,scale=T))
fit <- lm(收盘价 ~ 开盘价 + 最高价 + 最低价 + 成交量 + 成交额, data = sxfj1)
library(stargazer)
sxfj2 <- data.frame(sxfj)
stargazer(sxfj2, out = '~/Desktop/s.html')
stargazer(cor(sxfj1), type = 'html', out = '~/Documents/经济预测与决策/图片/cor.html')
plot(sxfj1)
stargazer(fit, type = 'html', out = '~/Documents/经济预测与决策/图片/lm.html')
dwtest(fit)
stargazer(anova(fit), type = 'html', out = '~/Documents/经济预测与决策/图片/anova.html')
par(family='STKaiti')
par(mfrow=c(2,2))
plot(fit)
library(lmtest)
bp <- bptest(fit)
stargazer(bp, type = 'html', out = '~/Documents/经济预测与决策/图片/bp.html')
library(car)
v <- vif(fit)
stargazer(vif(fit), type = 'html', out = '~/Documents/经济预测与决策/图片/vif.html')
stargazer(vif(fit),sqrt(vif(fit)) > 2, type = 'html', out = '~/Documents/经济预测与决策/图片/vif.html')
library(psych)
KMO(cor(sxfj1))
bartlett.test(sxfj1)
par(mfrow=c(1,1))
sxfj_cor <- cor(sxfj1[,-6])
fa.parallel(sxfj_cor, n.obs = 233, fa='both', n.iter=100)
fa <- fa(sxfj_cor, nfactors = 2, rotate='varimax', fm='pa')
fa
factor.plot(fa, lables=rownames(fa$loadings))
fa$weights
fw <- fa$weights
View(fw)
fa.diagram(fa, simple = F)
View(sxfj2)
f1 <- sxfj1$开盘价*fa$weights[1]+sxfj1$最高价*fa$weights[2]+sxfj1$最低价*fa$weights[3]+sxfj1$成交量*fa$weights[4]+sxfj1$成交额*fa$weights[5]
f2 <- sxfj1$开盘价*fa$weights[6]+sxfj1$最高价*fa$weights[7]+sxfj1$最低价*fa$weights[8]+sxfj1$成交量*fa$weights[9]+sxfj1$成交额*fa$weights[10]
sxfj2 <- data.frame(sxfj1,f1,f2)
fit2 <- lm(收盘价 ~ f1 + f2, data = sxfj2)
summary(fit2)
par(mfrow=c(2,2))
plot(fit2)
cor(f1,f2)
vif(fit2)
